<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¥é€é ç´„è¡¨å–®</title>
<style>
:root {
  --radius: 10px;
  --bg-body: #111827;
  --bg-container: #1f2937;
  --text-primary: #f3f4f6;
  --text-secondary: #9ca3af;
  --border: #4b5563;
  --input-bg: #374151;
  --success-bg: #065f46;
  --success-text: #d1fae5;
  --error-bg: #7f1d1d;
  --error-text: #fee2e2;
}
*{box-sizing:border-box;}
body {
  font-family: system-ui, -apple-system, sans-serif;
  margin: 0;
  padding: 16px;
  background: var(--bg-body);
  color: var(--text-primary);
  font-size: 17px;
}
.container {
  max-width: 640px;
  margin: auto;
  background: var(--bg-container);
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
}
h2 {
  text-align: center;
  margin: 0 0 24px;
  font-size: 24px;
  color: var(--text-primary);
}
label {
  display: block;
  margin: 16px 0 6px;
  font-weight: 600;
  color: var(--text-primary);
}
input, select {
  width: 100%;
  padding: 12px 14px;
  font-size: 17px;
  background: var(--input-bg);
  color: var(--text-primary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
input::placeholder {
  color: #6b7280;
}
button {
  width: 100%;
  padding: 14px;
  font-size: 18px;
  font-weight: 600;
  color: white;
  background: linear-gradient(135deg, #10b981, #059669);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  margin-top: 24px;
}
button:disabled {
  opacity: 0.6;
}
#message {
  display: none;
  margin-top: 16px;
  padding: 14px;
  border-radius: var(--radius);
  text-align: center;
  font-size: 17px;
}
#message.success {
  background: var(--success-bg);
  color: var(--success-text);
}
#message.error {
  background: var(--error-bg);
  color: var(--error-text);
}
.note {
  font-size: 14px;
  color: var(--text-secondary);
  margin-top: 4px;
  line-height: 1.4;
}
@media (max-width:480px) {
  body { font-size: 18px; }
  input, select, button { font-size: 18px; }
}
</style>
</head>
<body>

<div class="container">
  <h2>ğŸš— æ¥é€é ç´„è¡¨å–®</h2>

  <form id="bookingForm">

    <label>ğŸ“… æ—¥æœŸ</label>
    <input type="date" id="date" required>

    <label>ğŸ•’ å‡ºç™¼æ™‚é–“</label>
    <input type="time" id="time" required>
    <div class="note">
      â€» å»ºè­°æå‰æ™‚é–“ï¼š<br>
      â€¢ åœ‹éš›ç·šï¼š2.5â€“3 å°æ™‚å‰åˆ°æ©Ÿå ´<br>
      â€¢ åœ‹å…§ç·šï¼š1â€“1.5 å°æ™‚å‰åˆ°æ©Ÿå ´
    </div>

    <label>âœˆï¸ èˆªç­è™Ÿç¢¼</label>
    <input type="text" id="flight" required placeholder="ä¾‹ï¼šCI123">

    <label>ğŸ¢ èˆªå»ˆ</label>
    <select id="terminal" required>
      <option value="">è«‹é¸æ“‡</option>
      <option value="T1">T1</option>
      <option value="T2">T2</option>
      <option value="T3">T3</option>
    </select>

    <label>ğŸ“ å‡ºç™¼åœ°</label>
    <input type="text" id="start" required placeholder="ä¾‹ï¼šå°ä¸­å¸‚è¥¿å±¯å€">

    <label>ğŸ›£ï¸ ä¸­é€”åœé ï¼ˆå¯å¤šå€‹ï¼Œç”¨ + åˆ†éš”ï¼‰</label>
    <input type="text" id="via" placeholder="ä¾‹ï¼šå°ä¸­ç«è»Šç«™+é«˜éµå°ä¸­ç«™">

    <label>ğŸ“ ç›®çš„åœ°</label>
    <input type="text" id="end" required list="airportList" placeholder="ä¾‹ï¼šæ¡ƒåœ’åœ‹éš›æ©Ÿå ´ æˆ– å…¶ä»–åœ°å€">
    <datalist id="airportList">
      <option value="æ¡ƒåœ’åœ‹éš›æ©Ÿå ´">
      <option value="æ¾å±±åœ‹éš›æ©Ÿå ´">
    </datalist>

    <label>ğŸš™ è»Šå‹ï¼ˆè¡Œæåƒè€ƒï¼‰</label>
    <select id="car" required>
      <option value="">è«‹é¸æ“‡</option>
      <option value="èˆ’é©è½è»Š">èˆ’é©è½è»Šï¼ˆ1â€“2 ä»¶ï¼‰</option>
      <option value="äº”åº§ä¼‘æ—…">äº”åº§ä¼‘æ—…ï¼ˆ3â€“4 ä»¶ï¼‰</option>
      <option value="7äººåº§">7äººåº§ï¼ˆ3â€“4 ä»¶ï¼‰</option>
      <option value="8-9åº§å¤§è»Š">8-9åº§å¤§è»Šï¼ˆ6ä»¶â†‘ï¼‰</option>
    </select>
    <div class="note">â€» è¡Œæä»¶æ•¸ç‚º28â€“30å‹å¤§å‹è¡Œæä¼°è¨ˆï¼›ç‰¹æ®Šè¡Œæè«‹æ–¼å‚™è¨»èªªæ˜</div>

    <label>ğŸ§³ è¡Œæå‚™è¨»</label>
    <input type="text" id="luggageNote" placeholder="ä¾‹ï¼š2å¤§2å° + å¬°å…’è»Š">

    <label>ğŸª‘ å…’ç«¥åº§æ¤…</label>
    <select id="childSeat">
      <option value="ä¸éœ€è¦" selected>ä¸éœ€è¦</option>
      <option value="å®‰å…¨åº§æ¤…">å®‰å…¨åº§æ¤…</option>
      <option value="å¢é«˜å¢Š">å¢é«˜å¢Š</option>
    </select>

    <label>ğŸ‘¤ å§“å</label>
    <input type="text" id="name" required>

    <label>ğŸ“± é›»è©±</label>
    <input type="tel" id="phone" required placeholder="ä¾‹ï¼š0912345678">

    <button type="submit">é€å‡ºé ç´„</button>
  </form>

  <div id="message"></div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwzW_ODiW6zX5u9qBlsZziHPVEXcbCDAIcvfNRZDsCOiB_kla6RozEZam4FWxKMC0WRIg/exec";

document.getElementById("date").value = new Date().toISOString().slice(0,10);

// èˆªç­è‡ªå‹•è½‰å¤§å¯«
document.getElementById("flight").addEventListener("blur", e => {
  e.target.value = e.target.value.trim().toUpperCase();
});

document.getElementById("bookingForm").addEventListener("submit", async e => {
  e.preventDefault();
  const btn = e.target.querySelector("button");
  btn.disabled = true;
  btn.textContent = "è™•ç†ä¸­â€¦";

  const form = e.target;
  const payload = {
    date: form.date.value,
    time: form.time.value,
    flight: form.flight.value.trim().toUpperCase(),
    terminal: form.terminal.value,
    start: form.start.value.trim(),
    end: form.end.value.trim(),
    car: form.car.value,
    luggageNote: form.luggageNote.value.trim() || "ç„¡",
    childSeat: form.childSeat.value || "ä¸éœ€è¦",
    via: form.via.value.trim() || "ç„¡",
    name: form.name.value.trim(),
    phone: form.phone.value.trim()
  };

  const required = ["date", "time", "flight", "terminal", "start", "end", "car", "name", "phone"];
  for (let id of required) {
    if (!payload[id]) {
      showMsg("è«‹å¡«å¯«æ‰€æœ‰å¸¶ * çš„æ¬„ä½", "error");
      resetBtn();
      return;
    }
  }

  try {
    const formData = new URLSearchParams();
    for (const key in payload) {
      formData.append(key, payload[key]);
    }

    const res = await fetch(WEB_APP_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: formData
    });

    if (!res.ok) {
      throw new Error(`ä¼ºæœå™¨å›æ‡‰ ${res.status}`);
    }

    const data = await res.json();

    if (data.status === "ok") {
      showMsg("é ç´„å·²é€å‡ºï¼Œæˆ‘å€‘æœƒç›¡å¿«ç¢ºèª", "success");
      form.reset();
      form.date.value = new Date().toISOString().slice(0,10);
      form.childSeat.value = "ä¸éœ€è¦";
    } else {
      showMsg(data.message || "é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦", "error");
    }
  } catch (err) {
    let msg = "é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–ç¨å¾Œå†è©¦";
    if (err.message.includes("NetworkError") || err.message.includes("Failed to fetch")) {
      msg = "ç„¡æ³•é€£æ¥åˆ°ä¼ºæœå™¨ï¼Œè«‹ç¢ºèªç¶²è·¯æ˜¯å¦æ­£å¸¸";
    } else if (err.message.includes("ä¼ºæœå™¨å›æ‡‰")) {
      msg = "ä¼ºæœå™¨ç™¼ç”Ÿå•é¡Œï¼Œè«‹ç¨å¾Œå†è©¦";
    }
    showMsg(msg, "error");
  }

  resetBtn();
});

function showMsg(text, type) {
  const m = document.getElementById("message");
  m.textContent = text;
  m.className = type;
  m.style.display = "block";
  setTimeout(() => m.style.display = "none", 6000);
}

function resetBtn() {
  const btn = document.querySelector("button");
  btn.disabled = false;
  btn.textContent = "é€å‡ºé ç´„";
}
</script>
</body>
</html>