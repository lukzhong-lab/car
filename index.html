<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>æ¥é€é ç´„è¡¨å–®</title>
  <style>
    * { box-sizing: border-box; }
    html, body { 
      margin: 0; padding: 0; min-height: 100vh; 
      font-family: system-ui, -apple-system, sans-serif; 
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
    body { 
      max-width: 100%; padding: 15px; 
      display: flex; flex-direction: column; 
      min-height: 100vh; 
    }
    .container { max-width: 600px; margin: 0 auto; width: 100%; flex: 1; }
    h2 { 
      text-align: center; color: #1a1a1a; 
      margin: 20px 0 30px; font-size: 1.5rem; 
      font-weight: 700; 
    }
    label { 
      display: block; margin: 18px 0 8px; 
      font-weight: 600; color: #333; font-size: 1rem; 
    }
    input, select { 
      width: 100%; padding: 14px 16px; 
      border: 2px solid #e1e5e9; border-radius: 12px; 
      font-size: 16px; background: white; 
      transition: all 0.2s; 
    }
    input:focus, select:focus { 
      outline: none; border-color: #10b981; 
      box-shadow: 0 0 0 4px rgba(16,185,129,0.1); 
    }
    button { 
      width: 100%; padding: 16px; margin-top: 24px; 
      background: linear-gradient(135deg, #10b981, #059669); 
      color: white; border: none; border-radius: 12px; 
      font-size: 1.1rem; font-weight: 600; 
      cursor: pointer; transition: all 0.2s; 
    }
    button:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 0 8px 25px rgba(16,185,129,0.3); }
    button:disabled { background: #9ca3af; cursor: not-allowed; transform: none; }
    #message { 
      padding: 16px; margin-top: 20px; border-radius: 12px; 
      text-align: center; display: none; font-weight: 500; 
    }
    .success { background: #d1fae5; color: #065f46; border: 2px solid #a7f3d0; }
    .error { background: #fee2e2; color: #991b1b; border: 2px solid #fca5a5; }
    .note, .warning { 
      font-size: 0.9rem; line-height: 1.5; 
      margin: 4px 0 20px; padding: 12px; 
      border-radius: 8px; 
    }
    .warning {
      color: #c2410c;
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
    }
    @media (max-width: 480px) { 
      body { padding: 10px; } 
      h2 { font-size: 1.3rem; margin: 15px 0 25px; }
      input, select, button { padding: 16px 14px; font-size: 17px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸš— æ¥é€é ç´„è¡¨å–®</h2>
    
    <form id="bookingForm">
      <label>ğŸ“… æ—¥æœŸ</label>
      <input type="date" id="date" required>
      
      <label>ğŸ•’ å‡ºç™¼æ™‚é–“</label>
      <div class="warning">
        <strong>æŠµé”æ©Ÿå ´å»ºè­°æ™‚é–“ï¼š</strong><br>
        â€¢ åœ‹éš›ç·š (International Flights)ï¼šå»ºè­°åœ¨èµ·é£›å‰ 2 - 3 å°æ™‚æŠµé”æ©Ÿå ´ï¼Œè¾¦ç†å ±åˆ°å’Œå®‰æª¢ã€‚<br>
        â€¢ åœ‹å…§ç·š (Domestic Flights)ï¼šå»ºè­°åœ¨èµ·é£›å‰ 1 å°æ™‚æŠµé”ï¼Œæœ€æ™šåœ¨èµ·é£›å‰ 30 åˆ†é˜å®Œæˆå ±åˆ°ã€‚<br>
        â€¢ é£›å¾€ç¾åœ‹èˆªç­ï¼šç”±æ–¼å®‰å…¨æª¢æŸ¥åš´æ ¼ï¼Œå»ºè­°ææ—© 3 å°æ™‚ã€‚
      </div>
      <input type="time" id="time" required>
      
      <label>âœˆï¸ èˆªç­è™Ÿç¢¼</label>
      <input type="text" id="flightNumber" placeholder="ä¾‹å¦‚ï¼šCI123 / BR456 / JX789" required oninput="this.value = this.value.toUpperCase();">
      
      <label>ğŸ¢ èˆªå»ˆ</label>
      <select id="terminal" required>
        <option value="">è«‹é¸æ“‡èˆªå»ˆ</option>
        <option value="T1">T1</option>
        <option value="T2">T2</option>
        <option value="T3">T3</option>
      </select>
      
      <label>ğŸ“ å‡ºç™¼åœ°</label>
      <input type="text" id="startAddress" placeholder="è«‹è¼¸å…¥å®Œæ•´åœ°å€ï¼ˆå«ç¸£å¸‚ã€è·¯åã€è™Ÿç¢¼ï¼‰" required>
      
      <label>ğŸ›£ï¸ ä¸­é€”åœé é»ï¼ˆé¸å¡«ï¼Œå¯å¤šå€‹ï¼Œç”¨é€—è™Ÿåˆ†éš”ï¼‰</label>
      <input type="text" id="viaPoints" placeholder="ä¾‹å¦‚ï¼šå°åŒ—è»Šç«™, æ¾å±±æ©Ÿå ´">
      
      <label>ğŸ“ ç›®çš„åœ°</label>
      <select id="endAddress" required>
        <option value="">è«‹é¸æ“‡æˆ–è¼¸å…¥ç›®çš„åœ°</option>
        <option value="æ¡ƒåœ’æ©Ÿå ´">æ¡ƒåœ’æ©Ÿå ´</option>
        <option value="æ¾å±±æ©Ÿå ´">æ¾å±±æ©Ÿå ´</option>
        <option value="å…¶ä»–">å…¶ä»–ï¼ˆè«‹æ‰‹å‹•è¼¸å…¥å®Œæ•´åœ°å€ï¼‰</option>
      </select>
      <input type="text" id="endAddressCustom" placeholder="è‹¥é¸ã€Œå…¶ä»–ã€ï¼Œè«‹è¼¸å…¥å®Œæ•´åœ°å€" style="margin-top: 8px; display: none;">
      
      <label>ğŸš™ è»Šå‹é¸æ“‡ï¼ˆå«è¡Œæåƒè€ƒï¼‰</label>
      <select id="carType" required>
        <option value="">è«‹é¸æ“‡è»Šå‹</option>
        <option value="èˆ’é©è½è»Šï¼ˆè¡Œæç´„1-2ä»¶ï¼‰">èˆ’é©è½è»Šï¼ˆè¡Œæç´„1-2ä»¶ï¼‰</option>
        <option value="äº”åº§ä¼‘æ—…ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰">äº”åº§ä¼‘æ—…ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰</option>
        <option value="7äººåº§ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰">7äººåº§ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰</option>
        <option value="8-9åº§å¤§è»Šï¼ˆè¡Œæ6ä»¶ä»¥ä¸Šï¼‰">8-9åº§å¤§è»Šï¼ˆè¡Œæ6ä»¶ä»¥ä¸Šï¼‰</option>
      </select>
      <div class="note">
        <strong>è»Šå‹èˆ‡è¡Œææé†’ï¼š</strong><br>
        è«‹ä¾å¯¦éš›è¡Œææ•¸é‡ï¼ˆå¤§å‹è¡Œæç®±ç‚ºä¸»ï¼‰é¸æ“‡é©åˆè»Šå‹ã€‚<br>
        è‹¥è¡Œæè¶…å¤šæˆ–æœ‰ç‰¹æ®Šç‰©å“ï¼Œè«‹åœ¨å‚™è¨»èªªæ˜ã€‚
      </div>
      
      <label>ğŸª‘ å…’ç«¥å®‰å…¨åº§æ¤… / å¢é«˜å¢Šéœ€æ±‚</label>
      <select id="childSeat" required>
        <option value="">è«‹é¸æ“‡</option>
        <option value="ä¸éœ€è¦">ä¸éœ€è¦</option>
        <option value="éœ€è¦å®‰å…¨åº§æ¤…">éœ€è¦å®‰å…¨åº§æ¤…ï¼ˆ0-4æ­²ï¼‰</option>
        <option value="éœ€è¦å¢é«˜å¢Š">éœ€è¦å¢é«˜å¢Šï¼ˆ4-12æ­²å»ºè­°ï¼‰</option>
      </select>
      <div class="note">
        <strong>âš ï¸ æ³•è¦æé†’ï¼š</strong><br>
        0~4æ­²å¹¼ç«¥å¿…é ˆä½¿ç”¨åˆæ ¼å®‰å…¨åº§æ¤…ï¼ˆå¾Œåº§ï¼‰ï¼Œ4~12æ­²å»ºè­°ä½¿ç”¨å¢é«˜å¢Šã€‚<br>
        æœªä½¿ç”¨å¯ç½°1,500~3,000å…ƒï¼Œè«‹ä¾å¯¦éš›å¹´é½¡/é«”é‡é¸æ“‡ã€‚
      </div>
      
      <label>ğŸ‘¤ å§“å</label>
      <input type="text" id="name" required>
      
      <label>ğŸ“± é›»è©±</label>
      <input type="tel" id="phone" placeholder="0912345678 æˆ– +886912345678" required>
      
      <button type="button" id="submitBtn">âœ… é€å‡ºé ç´„</button>
    </form>
    
    <div id="message"></div>
  </div>

  <!-- EmailJS SDK -->
  <script defer src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  
  <script>
    function initApp() {
      if (typeof emailjs === 'undefined') {
        console.warn('EmailJS SDK é‚„æœªè¼‰å…¥ï¼Œç¨å¾Œé‡è©¦...');
        setTimeout(initApp, 1000);
        return;
      }
      
      console.log('EmailJS SDK å·²è¼‰å…¥');
      
      emailjs.init({ publicKey: "3NaCLzxTOKYgHeXyP" });
      
      const today = new Date().toISOString().slice(0, 10);
      document.getElementById('date').value = today;
      
      // ç›®çš„åœ°é¸æ“‡ï¼šå¦‚æœé¸ã€Œå…¶ä»–ã€ï¼Œé¡¯ç¤ºè‡ªè¨‚è¼¸å…¥æ¡†
      const endSelect = document.getElementById('endAddress');
      const endCustom = document.getElementById('endAddressCustom');
      endSelect.addEventListener('change', () => {
        if (endSelect.value === 'å…¶ä»–') {
          endCustom.style.display = 'block';
          endCustom.required = true;
        } else {
          endCustom.style.display = 'none';
          endCustom.required = false;
          endCustom.value = '';
        }
      });
      
      const btn = document.getElementById('submitBtn');
      const msgDiv = document.getElementById('message');
      
      btn.addEventListener('click', async () => {
        if (btn.disabled) return;
        
        btn.disabled = true;
        btn.textContent = 'ğŸ“¤ é€å‡ºä¸­...';
        
        let endValue = endSelect.value;
        if (endSelect.value === 'å…¶ä»–') {
          endValue = endCustom.value.trim();
          if (!endValue) {
            showMsg('âŒ è‹¥ç›®çš„åœ°ç‚ºã€Œå…¶ä»–ã€ï¼Œè«‹å¡«å¯«å®Œæ•´åœ°å€ï¼', 'error');
            resetBtn();
            return;
          }
        }
        
        const params = {
          date: document.getElementById('date').value,
          time: document.getElementById('time').value,
          flight: document.getElementById('flightNumber').value.trim().toUpperCase(),
          terminal: document.getElementById('terminal').value,
          start: document.getElementById('startAddress').value.trim(),
          via: document.getElementById('viaPoints').value.trim() || 'ç„¡',
          end: endValue,
          car: document.getElementById('carType').value,
          childSeat: document.getElementById('childSeat').value,
          name: document.getElementById('name').value.trim(),
          phone: document.getElementById('phone').value.trim()
        };
        
        const required = ['date','time','flight','terminal','start','end','car','childSeat','name','phone'];
        const missing = required.filter(k => !params[k]);
        if (missing.length) {
          showMsg('âŒ è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼', 'error');
          resetBtn();
          return;
        }
        
        console.log('é€å‡ºè³‡æ–™ï¼š', params);
        
        try {
          await emailjs.send('service_gd932ui', 'template_53hb8ks', params);
          showMsg('âœ… é ç´„æˆåŠŸï¼å®Œæ•´è³‡è¨Šå·²å¯„å‡ºï¼Œæˆ‘å€‘æœƒç›¡å¿«è¯ç¹«ç¢ºèªã€‚', 'success');
          
          document.getElementById('bookingForm').reset();
          document.getElementById('date').value = today;
          endCustom.style.display = 'none';
        } catch (err) {
          console.error('EmailJS éŒ¯èª¤ï¼š', err);
          showMsg('âŒ å¯„ä¿¡å¤±æ•—ï¼Œè«‹ç›´æ¥è¯ç¹«æˆ‘å€‘æˆ–é‡æ–°é€å‡ºã€‚', 'error');
        } finally {
          setTimeout(() => msgDiv.style.display = 'none', 10000);
          resetBtn();
        }
      });
      
      function showMsg(text, type) {
        msgDiv.innerHTML = text;
        msgDiv.className = type;
        msgDiv.style.display = 'block';
      }
      
      function resetBtn() {
        btn.disabled = false;
        btn.textContent = 'âœ… é€å‡ºé ç´„';
      }
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
    window.addEventListener('load', initApp);
  </script>
</body>
</html>