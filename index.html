<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¥é€é ç´„è¡¨å–®</title>

<style>
:root{
  --bg-body:#111827;
  --bg-box:#1f2937;
  --input:#374151;
  --border:#4b5563;
  --text:#f3f4f6;
  --sub:#9ca3af;
  --danger:#ef4444;
  --ok:#065f46;
}
*{box-sizing:border-box}
body{
  margin:0;padding:16px;
  font-family:system-ui;
  background:var(--bg-body);
  color:var(--text);
}
.container{
  max-width:640px;
  margin:auto;
  background:var(--bg-box);
  padding:20px;
  border-radius:14px;
}
h2{text-align:center;margin-bottom:24px}
label{display:block;margin-top:16px;font-weight:600}
input,select{
  width:100%;
  padding:12px;
  background:var(--input);
  border:1px solid var(--border);
  color:var(--text);
  border-radius:10px;
  font-size:17px;
}
.note{font-size:14px;color:var(--sub);margin-top:4px}
.note.danger{color:var(--danger);font-weight:600}
button{
  margin-top:24px;
  width:100%;
  padding:14px;
  font-size:18px;
  font-weight:600;
  background:linear-gradient(135deg,#10b981,#059669);
  border:none;border-radius:10px;color:white;
}
.add-btn{
  margin-top:8px;
  padding:10px;
  width:100%;
  background:#374151;
  border:1px dashed var(--border);
  color:#e5e7eb;
  border-radius:8px;
}
.via-item{margin-top:8px}
#message{
  display:none;margin-top:16px;
  padding:14px;text-align:center;border-radius:10px
}
#message.success{background:var(--ok)}
#message.error{background:#7f1d1d}
</style>
</head>

<body>
<div class="container">
<h2>ğŸš— æ¥é€é ç´„è¡¨å–®</h2>

<form id="bookingForm">

<label>ğŸ“… æ—¥æœŸ</label>
<input type="date" name="date" required>
<div class="note" id="weekday"></div>

<label>ğŸ•’ å‡ºç™¼æ™‚é–“</label>
<input type="time" name="time" required>
<div class="note danger">
â€» åœ‹éš›ç·š 2.5â€“3 å°æ™‚ï½œåœ‹å…§ç·š 1â€“1.5 å°æ™‚
</div>

<label>âœˆï¸ èˆªç­è™Ÿç¢¼</label>
<input type="text" name="flight" required placeholder="ä¾‹ï¼šCI123">

<!-- èˆªå»ˆï¼ˆæ©Ÿå ´æ‰é¡¯ç¤ºï¼‰ -->
<div id="terminalBlock" style="display:none;">
  <label>ğŸ¢ èˆªå»ˆ</label>
  <select name="terminal" id="terminalSelect">
    <option value="">è«‹é¸æ“‡èˆªå»ˆ</option>
    <option value="T1èˆªå»ˆ">T1 èˆªå»ˆ</option>
    <option value="T2èˆªå»ˆ">T2 èˆªå»ˆ</option>
    <option value="T3èˆªå»ˆ">T3 èˆªå»ˆ</option>
  </select>
  <div class="note">â€» åƒ…æ©Ÿå ´æ¥é€éœ€é¸æ“‡</div>
</div>

<label>ğŸ“ å‡ºç™¼åœ°</label>
<input type="text" name="start" required>

<label>ğŸ›£ï¸ ä¸­é€”åœé </label>
<div id="viaList">
  <input type="text" class="via-item" placeholder="è¼¸å…¥ä¸­é€”åœ°å€">
</div>
<button type="button" class="add-btn" onclick="addVia()">ï¼‹ æ–°å¢åœé é»</button>

<label>ğŸ“ ç›®çš„åœ°</label>
<select name="end" id="endSelect" required>
  <option value="">è«‹é¸æ“‡</option>
  <option value="è‡ªè¨‚">è‡ªè¨‚åœ°å€</option>
  <option value="æ¡ƒåœ’åœ‹éš›æ©Ÿå ´">æ¡ƒåœ’åœ‹éš›æ©Ÿå ´</option>
  <option value="æ¾å±±åœ‹éš›æ©Ÿå ´">æ¾å±±åœ‹éš›æ©Ÿå ´</option>
</select>

<input id="customEnd" type="text" placeholder="è«‹è¼¸å…¥ç›®çš„åœ°åœ°å€"
  style="display:none;margin-top:8px">

<div class="note" id="customEndNote" style="display:none">
â€» è«‹å¡«å¯«å®Œæ•´åœ°å€
</div>

<label>ğŸš™ è»Šå‹</label>
<select name="car" required>
  <option value="">è«‹é¸æ“‡</option>
  <option value="èˆ’é©è½è»Š">èˆ’é©è½è»Šï¼ˆ1â€“2 ä»¶ï¼‰</option>
  <option value="äº”åº§ä¼‘æ—…">äº”åº§ä¼‘æ—…ï¼ˆ3â€“4 ä»¶ï¼‰</option>
  <option value="7äººåº§">7äººåº§ï¼ˆ3â€“4 ä»¶ï¼‰</option>
  <option value="8-9åº§å¤§è»Š">8â€“9 åº§ï¼ˆ6 ä»¶â†‘ï¼‰</option>
</select>

<label>ğŸ§³ è¡Œæå‚™è¨» <span class="note">ï¼ˆå¯ä¸å¡«ï¼‰</span></label>
<input type="text" name="luggageNote">

<label>ğŸª‘ å…’ç«¥åº§æ¤…</label>
<select name="childSeat">
  <option value="ä¸éœ€è¦">ä¸éœ€è¦</option>
  <option value="å®‰å…¨åº§æ¤…">å®‰å…¨åº§æ¤…</option>
  <option value="å¢é«˜å¢Š">å¢é«˜å¢Š</option>
</select>
<div class="note danger">
â€» 4 æ­²ä»¥ä¸‹æˆ–èº«é«˜æœªæ»¿ 150cm å»ºè­°ä½¿ç”¨å…’ç«¥åº§æ¤…
</div>

<label>ğŸ‘¤ å§“å</label>
<input type="text" name="name" required>

<label>ğŸ“± é›»è©±</label>
<input type="tel" name="phone" required>

<button type="submit">é€å‡ºé ç´„</button>
</form>

<div id="message"></div>
</div>

<script>
const dateInput=document.querySelector('[name="date"]');
const weekday=document.getElementById("weekday");
dateInput.value=new Date().toISOString().slice(0,10);
updateDay();
dateInput.onchange=updateDay;
function updateDay(){
  const w=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
  weekday.textContent="æ˜ŸæœŸ"+w[new Date(dateInput.value).getDay()];
}

document.querySelector('[name="flight"]').onblur=e=>{
  e.target.value=e.target.value.trim().toUpperCase();
};

function addVia(){
  const i=document.createElement("input");
  i.className="via-item";
  i.placeholder="è¼¸å…¥ä¸­é€”åœ°å€";
  document.getElementById("viaList").appendChild(i);
}

const endSelect=document.getElementById("endSelect");
const customEnd=document.getElementById("customEnd");
const customEndNote=document.getElementById("customEndNote");
const terminalBlock=document.getElementById("terminalBlock");
const terminalSelect=document.getElementById("terminalSelect");

endSelect.onchange=()=>{
  const airport=["æ¡ƒåœ’åœ‹éš›æ©Ÿå ´","æ¾å±±åœ‹éš›æ©Ÿå ´"].includes(endSelect.value);

  terminalBlock.style.display=airport?"block":"none";
  terminalSelect.required=airport;

  if(endSelect.value==="è‡ªè¨‚"){
    customEnd.style.display="block";
    customEndNote.style.display="block";
    customEnd.required=true;
  }else{
    customEnd.style.display="none";
    customEndNote.style.display="none";
    customEnd.required=false;
    customEnd.value="";
  }

  if(!airport){
    terminalSelect.value="";
  }
};

const form=document.getElementById("bookingForm");
const msg=document.getElementById("message");

form.onsubmit=e=>{
  e.preventDefault();

  let ok=true;
  form.querySelectorAll("[required]").forEach(i=>{
    if(!i.value.trim()) ok=false;
  });
  if(!ok){show("è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½","error");return;}

  const obj={};
  new FormData(form).forEach((v,k)=>obj[k]=v);

  if(obj.end==="è‡ªè¨‚"){
    obj.end=customEnd.value.trim();
  }

  obj.via=[...document.querySelectorAll(".via-item")]
    .map(i=>i.value.trim()).filter(Boolean).join("+");

  fetch("https://script.google.com/macros/s/AKfycbwG-V_zY5OdBVw7SyQIV8yrsvBDDKQqqisk43m2zsiELAcCixnXPBLPrxIrSiMmsgYE/exec",{
    method:"POST",
    body:new URLSearchParams(obj)
  }).then(r=>r.json())
   .then(r=>show(r.status==="ok"?"é ç´„å·²é€å‡º":"é€å‡ºå¤±æ•—","success"))
   .catch(err=>show(err,"error"));
};

function show(t,c){
  msg.textContent=t;
  msg.className=c;
  msg.style.display="block";
  setTimeout(()=>msg.style.display="none",8000);
}
</script>
</body>
</html>
