<script>
// 建議出發時間生成（跨日紅色顯示）
function updateSuggestedDeparture() {
  const hour = parseInt(hourSelect.value);
  const minute = parseInt(minuteSelect.value);
  if(isNaN(hour) || isNaN(minute)) return;

  suggestedSelect.innerHTML = ""; // 清空

  const flightDate = new Date(dateInput.value);
  flightDate.setHours(hour, minute, 0, 0);

  // 生成前 4 小時到航班時間每 15 分鐘選項
  for(let mins = 240; mins >= 0; mins -= 15){
    const d = new Date(flightDate.getTime() - mins*60000);
    const y = d.getFullYear();
    const mo = (d.getMonth()+1).toString().padStart(2,'0');
    const da = d.getDate().toString().padStart(2,'0');
    const h = d.getHours().toString().padStart(2,'0');
    const mi = d.getMinutes().toString().padStart(2,'0');
    const opt = document.createElement('option');
    opt.value = `${y}-${mo}-${da} ${h}:${mi}`;
    opt.textContent = `${y}-${mo}-${da} ${h}:${mi}`;

    // 判斷是否跨日
    const flightY = flightDate.getFullYear();
    const flightMo = flightDate.getMonth();
    const flightDa = flightDate.getDate();
    if(d.getFullYear() !== flightY || d.getMonth() !== flightMo || d.getDate() !== flightDa){
      opt.style.color = "red"; // 跨日紅色
    } else {
      opt.style.color = "black"; // 同日黑色
    }

    suggestedSelect.appendChild(opt);
  }

  suggestedSelect.selectedIndex = 0; // 預設選前 4 小時
}

hourSelect.addEventListener('change', updateSuggestedDeparture);
minuteSelect.addEventListener('change', updateSuggestedDeparture);
dateInput.addEventListener('change', updateSuggestedDeparture);
window.addEventListener('DOMContentLoaded', updateSuggestedDeparture);
</script>
