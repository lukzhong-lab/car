<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>æ¥é€é ç´„è¡¨å–®</title>

<style>
* { box-sizing: border-box; }
html, body {
  margin: 0;
  padding: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg,#f5f7fa,#c3cfe2);
}
body {
  padding: 12px;
  display: flex;
  justify-content: center;
}
.container {
  width: 100%;
  max-width: 600px;
}
h2 {
  text-align: center;
  margin: 16px 0 24px;
}
label {
  display: block;
  margin: 18px 0 6px;
  font-weight: 600;
}
input, select {
  width: 100%;
  padding: 16px;
  font-size: 17px;
  border-radius: 12px;
  border: 2px solid #e5e7eb;
}
input:focus, select:focus {
  outline: none;
  border-color: #10b981;
  box-shadow: 0 0 0 3px rgba(16,185,129,.15);
}
button {
  width: 100%;
  padding: 18px;
  font-size: 18px;
  border-radius: 14px;
  border: none;
  background: linear-gradient(135deg,#10b981,#059669);
  color: #fff;
  margin-top: 26px;
}
button:disabled {
  background: #9ca3af;
}
.note {
  font-size: 14px;
  background: #fef3c7;
  padding: 12px;
  border-radius: 8px;
  margin-top: 6px;
}
#message {
  display: none;
  margin-top: 20px;
  padding: 16px;
  border-radius: 12px;
  text-align: center;
}
.success {
  background: #d1fae5;
  color: #065f46;
}
.error {
  background: #fee2e2;
  color: #991b1b;
}

/* ===== ä¸­é€”åœé é» ===== */
.via-row {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}
.via-input {
  flex: 1;
}
.via-add, .via-remove {
  width: 48px;
  font-size: 22px;
  border-radius: 12px;
  border: none;
  color: #fff;
}
.via-add {
  background: #10b981;
}
.via-remove {
  background: #ef4444;
}
</style>
</head>

<body>
<div class="container">
<h2>ğŸš— æ¥é€é ç´„è¡¨å–®</h2>

<form id="bookingForm">

<label>ğŸ“… æ—¥æœŸ</label>
<input type="date" id="date" required>

<label>ğŸ•’ å‡ºç™¼æ™‚é–“</label>
<input type="time" id="time" required>

<label>âœˆï¸ èˆªç­è™Ÿç¢¼</label>
<input type="text" id="flightNumber" required placeholder="CI123" oninput="this.value=this.value.toUpperCase()">

<label>ğŸ¢ èˆªå»ˆ</label>
<select id="terminal" required>
<option value="">è«‹é¸æ“‡</option>
<option>T1</option>
<option>T2</option>
<option>T3</option>
</select>

<label>ğŸ“ å‡ºç™¼åœ°</label>
<input type="text" id="startAddress" required>

<label>ğŸ›£ï¸ ä¸­é€”åœé é»ï¼ˆé¸å¡«ï¼‰</label>
<div id="viaContainer">
  <div class="via-row">
    <input class="via-input" placeholder="è«‹è¼¸å…¥ä¸­é€”åœ°å€">
    <button type="button" class="via-add">ï¼‹</button>
  </div>
</div>

<label>ğŸ“ ç›®çš„åœ°</label>
<select id="endAddress" required>
<option value="">è«‹é¸æ“‡</option>
<option value="æ¡ƒåœ’æ©Ÿå ´">æ¡ƒåœ’æ©Ÿå ´</option>
<option value="æ¾å±±æ©Ÿå ´">æ¾å±±æ©Ÿå ´</option>
<option value="å…¶ä»–">å…¶ä»–</option>
</select>
<input id="endCustom" placeholder="è«‹è¼¸å…¥å®Œæ•´åœ°å€" style="display:none;margin-top:8px">

<label>ğŸš™ è»Šå‹</label>
<select id="carType" required>
<option value="">è«‹é¸æ“‡</option>
<option>èˆ’é©è½è»Š</option>
<option>äº”åº§ä¼‘æ—…</option>
<option>7äººåº§</option>
<option>8-9åº§</option>
</select>

<label>ğŸª‘ å…’ç«¥åº§æ¤…</label>
<select id="childSeat" required>
<option value="">è«‹é¸æ“‡</option>
<option>ä¸éœ€è¦</option>
<option>å®‰å…¨åº§æ¤…</option>
<option>å¢é«˜å¢Š</option>
</select>

<label>ğŸ‘¤ å§“å</label>
<input id="name" required>

<label>ğŸ“± é›»è©±</label>
<input id="phone" required>

<button type="button" id="submitBtn">âœ… é€å‡ºé ç´„</button>

</form>

<div id="message"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<script>
emailjs.init({ publicKey: "3NaCLzxTOKYgHeXyP" });

document.getElementById('date').value = new Date().toISOString().slice(0,10);

// ç›®çš„åœ°å…¶ä»–
const endSel = document.getElementById('endAddress');
const endCus = document.getElementById('endCustom');
endSel.onchange = () => {
  endCus.style.display = endSel.value === 'å…¶ä»–' ? 'block' : 'none';
};

// ä¸­é€”åœé é» + / -
document.getElementById('viaContainer').onclick = e => {
  if (e.target.classList.contains('via-add')) {
    const row = document.createElement('div');
    row.className = 'via-row';
    row.innerHTML = `
      <input class="via-input" placeholder="è«‹è¼¸å…¥ä¸­é€”åœ°å€">
      <button type="button" class="via-remove">âœ•</button>`;
    document.getElementById('viaContainer').appendChild(row);
  }
  if (e.target.classList.contains('via-remove')) {
    e.target.parentElement.remove();
  }
};

// é€å‡º
document.getElementById('submitBtn').onclick = async () => {
  const btn = event.target;
  btn.disabled = true;
  btn.textContent = 'é€å‡ºä¸­...';

  const vias = [...document.querySelectorAll('.via-input')]
    .map(v => v.value.trim())
    .filter(v => v)
    .join('ã€') || 'ç„¡';

  try {
    await emailjs.send(
      'service_gd932ui',
      'template_53hb8ks',
      {
        date: date.value,
        time: time.value,
        flight: flightNumber.value,
        terminal: terminal.value,
        start: startAddress.value,
        via: vias,
        end: endSel.value === 'å…¶ä»–' ? endCus.value : endSel.value,
        car: carType.value,
        childSeat: childSeat.value,
        name: name.value,
        phone: phone.value
      }
    );
    message.className = 'success';
    message.textContent = 'âœ… é ç´„æˆåŠŸï¼Œå·²é€å‡ºï¼';
  } catch {
    message.className = 'error';
    message.textContent = 'âŒ é€å‡ºå¤±æ•—ï¼Œè«‹é‡è©¦';
  }

  message.style.display = 'block';
  btn.disabled = false;
  btn.textContent = 'âœ… é€å‡ºé ç´„';
};
</script>
</body>
</html>
