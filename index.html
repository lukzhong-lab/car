<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¥é€é ç´„è¡¨å–®</title>
<style>
*{box-sizing:border-box;}
body{font-family:system-ui,-apple-system,sans-serif;margin:0;padding:15px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);}
.container{max-width:600px;margin:0 auto;}
h2{text-align:center;margin-bottom:30px;}
label{display:block;margin:15px 0 5px;font-weight:600;}
input,select,button{width:100%;padding:12px;border-radius:8px;border:1px solid #ccc;margin-bottom:10px;font-size:16px;}
button{background:linear-gradient(135deg, #10b981, #059669);color:white;border:none;cursor:pointer;transition: all 0.3s;}
button:hover:not(:disabled){opacity:0.9;transform:translateY(-1px);}
button:disabled{background:#9ca3af;cursor:not-allowed;transform:none;}
.note,.warning{font-size:0.9rem;padding:8px;border-radius:6px;margin-bottom:10px;}
.warning{background:#fef3c7;border-left:4px solid #f59e0b;color:#c2410c;}
.note{background:#d1fae5;border-left:4px solid #10b981;color:#065f46;}
#message{display:none;padding:12px;text-align:center;border-radius:8px;margin-top:10px;font-weight:500;opacity:0;transition: opacity 0.5s;}
#message.success{background:#d1fae5;color:#065f46;border:2px solid #10b981;}
#message.error{background:#fee2e2;color:#991b1b;border:2px solid #fca5a5;}
@media(max-width:480px){body{padding:10px;}h2{font-size:1.3rem;}}
</style>
</head>
<body>

<div class="container">
<h2>ğŸš— æ¥é€é ç´„è¡¨å–®</h2>

<form id="bookingForm">
  <label>ğŸ“… æ—¥æœŸ</label>
  <input type="date" id="date" required>

  <label>ğŸ•’ å‡ºç™¼æ™‚é–“</label>
  <div class="warning">
    <strong>æŠµé”æ©Ÿå ´å»ºè­°æ™‚é–“ï¼š</strong><br>
    â€¢ åœ‹éš›ç·šï¼šèµ·é£›å‰ 2-3 å°æ™‚<br>
    â€¢ åœ‹å…§ç·šï¼šèµ·é£›å‰ 1 å°æ™‚ï¼Œæœ€æ™š 30 åˆ†é˜<br>
    â€¢ ç¾åœ‹èˆªç­ï¼šèµ·é£›å‰ 3 å°æ™‚
  </div>
  <input type="time" id="time" required>

  <label>âœˆï¸ èˆªç­è™Ÿç¢¼</label>
  <input type="text" id="flightNumber" placeholder="CI123 / BR456" required oninput="this.value=this.value.toUpperCase();">

  <label>ğŸ¢ èˆªå»ˆ</label>
  <select id="terminal" required>
    <option value="">è«‹é¸æ“‡èˆªå»ˆ</option>
    <option value="T1">T1</option>
    <option value="T2">T2</option>
    <option value="T3">T3</option>
  </select>

  <label>ğŸ“ å‡ºç™¼åœ°</label>
  <input type="text" id="startAddress" placeholder="å®Œæ•´åœ°å€" required>

  <label>ğŸ“ ç›®çš„åœ°</label>
  <select id="endAddress" required>
    <option value="">è«‹é¸æ“‡æˆ–è¼¸å…¥</option>
    <option value="æ¡ƒåœ’æ©Ÿå ´">æ¡ƒåœ’æ©Ÿå ´</option>
    <option value="æ¾å±±æ©Ÿå ´">æ¾å±±æ©Ÿå ´</option>
    <option value="å…¶ä»–">å…¶ä»–</option>
  </select>
  <input type="text" id="endAddressCustom" placeholder="è‹¥é¸å…¶ä»–è«‹å¡«å®Œæ•´åœ°å€" style="display:none;margin-top:8px;">

  <label>ğŸš™ è»Šå‹é¸æ“‡ï¼ˆå«è¡Œæåƒè€ƒï¼‰</label>
  <select id="carType" required>
    <option value="">è«‹é¸è»Šå‹</option>
    <option value="èˆ’é©è½è»Šï¼ˆè¡Œæç´„1-2ä»¶ï¼‰">èˆ’é©è½è»Šï¼ˆè¡Œæç´„1-2ä»¶ï¼‰</option>
    <option value="äº”åº§ä¼‘æ—…ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰">äº”åº§ä¼‘æ—…ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰</option>
    <option value="7äººåº§ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰">7äººåº§ï¼ˆè¡Œæç´„3-4ä»¶ï¼‰</option>
    <option value="8-9åº§å¤§è»Šï¼ˆè¡Œæ6ä»¶ä»¥ä¸Šï¼‰">8-9åº§å¤§è»Šï¼ˆè¡Œæ6ä»¶ä»¥ä¸Šï¼‰</option>
  </select>

  <label>ğŸ§³ è¡Œæå‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
  <input type="text" id="luggageNote" placeholder="ä¾‹å¦‚ï¼šå¤§å‹è¡Œæ 3 ä»¶">

  <label>ğŸª‘ å…’ç«¥å®‰å…¨åº§æ¤… / å¢é«˜å¢Šéœ€æ±‚</label>
  <select id="childSeat" required>
    <option value="">è«‹é¸æ“‡</option>
    <option value="ä¸éœ€è¦">ä¸éœ€è¦</option>
    <option value="éœ€è¦å®‰å…¨åº§æ¤…">éœ€è¦å®‰å…¨åº§æ¤…ï¼ˆ0-4æ­²ï¼‰</option>
    <option value="éœ€è¦å¢é«˜å¢Š">éœ€è¦å¢é«˜å¢Šï¼ˆ4-12æ­²ï¼‰</option>
  </select>

  <label>ğŸ›£ï¸ ä¸­é€”åœé é»ï¼ˆé¸å¡«ï¼Œå¯å¤šå€‹ï¼‰</label>
  <div id="viaContainer">
    <input type="text" class="via-input" placeholder="ä¾‹å¦‚ï¼šå°åŒ—è»Šç«™">
  </div>
  <button type="button" id="addVia">â• æ–°å¢åœé é»</button>

  <label>ğŸ‘¤ å§“å</label>
  <input type="text" id="name" required>

  <label>ğŸ“± é›»è©±</label>
  <input type="tel" id="phone" placeholder="0912345678 æˆ– +886912345678" required>

  <button type="submit" id="submitBtn">âœ… é€å‡ºé ç´„</button>
</form>

<div id="message"></div>
</div>

<script>
const WEB_APP_URL = "YOUR_DEPLOYED_GAS_URL"; // æ›¿æ›æˆä½ çš„ Web App URL
document.getElementById("date").value = new Date().toISOString().slice(0,10);

const endAddress = document.getElementById("endAddress");
const endCustom = document.getElementById("endAddressCustom");
endAddress.addEventListener("change", ()=>{
  endCustom.style.display = endAddress.value==="å…¶ä»–"?"block":"none";
  endCustom.required = endAddress.value==="å…¶ä»–";
  if(endAddress.value!=="å…¶ä»–") endCustom.value="";
});

document.getElementById("addVia").addEventListener("click", ()=>{
  const input = document.createElement("input");
  input.type="text";
  input.placeholder="ä¸­é€”åœé åœ°å€ï¼ˆé¸å¡«ï¼‰";
  input.className="via-input";
  document.getElementById("viaContainer").appendChild(input);
});

const form = document.getElementById("bookingForm");
const btn = document.getElementById("submitBtn");
const msgDiv = document.getElementById("message");

form.addEventListener("submit", async (e)=>{
  e.preventDefault();
  btn.disabled=true;
  btn.textContent="ğŸ“¤ é€å‡ºä¸­...";

  const endValue = endAddress.value==="å…¶ä»–"? endCustom.value.trim() : endAddress.value;
  const viaPoints = [...document.getElementsByClassName("via-input")]
                     .map(v=>v.value.trim()).filter(v=>v).join("ã€") || "ç„¡";

  const payload = {
    date: document.getElementById("date").value,
    time: document.getElementById("time").value,
    flight: document.getElementById("flightNumber").value.trim().toUpperCase(),
    terminal: document.getElementById("terminal").value,
    start: document.getElementById("startAddress").value.trim(),
    via: viaPoints,
    end: endValue,
    car: document.getElementById("carType").value,
    luggageNote: document.getElementById("luggageNote").value.trim(),
    childSeat: document.getElementById("childSeat").value,
    name: document.getElementById("name").value.trim(),
    phone: document.getElementById("phone").value.trim()
  };

  try {
    const res = await fetch(WEB_APP_URL,{
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    const data = await res.json();
    if(data.status==="ok"){
      showMsg("âœ… é ç´„å·²é€å‡ºï¼ŒTelegram å³æ™‚é€šçŸ¥","success");
      form.reset();
      document.getElementById("date").value=new Date().toISOString().slice(0,10);
      endCustom.style.display="none";
    } else throw new Error(data.error || "å¾Œç«¯éŒ¯èª¤");
  } catch(err){
    console.error(err);
    showMsg("âŒ é€å‡ºå¤±æ•—ï¼Œè«‹é‡è©¦","error");
  } finally {
    btn.disabled=false;
    btn.textContent="âœ… é€å‡ºé ç´„";
  }
});

function showMsg(text,type){
  msgDiv.textContent=text;
  msgDiv.className=type;
  msgDiv.style.display="block";
  msgDiv.style.opacity="1";
  setTimeout(()=>{msgDiv.style.opacity="0";},5000);
  setTimeout(()=>{msgDiv.style.display="none";},5500);
}
</script>
</body>
</html>
